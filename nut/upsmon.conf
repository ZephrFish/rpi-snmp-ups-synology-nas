# NUT Monitor Configuration
# Controls upsmon which monitors UPS and initiates shutdowns

# ============================================================================
# Monitor Definition
# ============================================================================

# Monitor local UPS as master (can initiate shutdown)
MONITOR ups@localhost 1 monuser secret master

# For slave mode (does not initiate shutdown, just monitors)
# MONITOR ups@localhost 1 monuser secret slave

# ============================================================================
# Shutdown Settings
# ============================================================================

# Powerdown flag (shutdown UPS after system shutdown)
POWERDOWNFLAG /etc/killpower

# Shutdown command (systemd)
SHUTDOWNCMD "/sbin/shutdown -h +0"

# For non-systemd systems, use:
# SHUTDOWNCMD "/sbin/shutdown -h now"

# ============================================================================
# Notifications
# ============================================================================

# Notification types (wall, email, syslog)
NOTIFYFLAG ONLINE SYSLOG+WALL
NOTIFYFLAG ONBATT SYSLOG+WALL
NOTIFYFLAG LOWBATT SYSLOG+WALL+EXEC
NOTIFYFLAG FSD SYSLOG+WALL+EXEC
NOTIFYFLAG COMMOK SYSLOG+WALL
NOTIFYFLAG COMMBAD SYSLOG+WALL
NOTIFYFLAG SHUTDOWN SYSLOG+WALL+EXEC
NOTIFYFLAG REPLBATT SYSLOG+WALL
NOTIFYFLAG NOCOMM SYSLOG+WALL
NOTIFYFLAG NOPARENT SYSLOG+WALL

# ============================================================================
# Notification Timers (in seconds)
# ============================================================================

# Delay before sending notifications
NOTIFYMSG ONLINE "UPS %s on line power"
NOTIFYMSG ONBATT "UPS %s on battery"
NOTIFYMSG LOWBATT "UPS %s battery is low"
NOTIFYMSG FSD "UPS %s: forced shutdown in progress"
NOTIFYMSG COMMOK "Communications with UPS %s established"
NOTIFYMSG COMMBAD "Communications with UPS %s lost"
NOTIFYMSG SHUTDOWN "Auto logout and shutdown proceeding"
NOTIFYMSG REPLBATT "UPS %s battery needs replacement"
NOTIFYMSG NOCOMM "UPS %s is unavailable"
NOTIFYMSG NOPARENT "UPS %s unavailable - parent process died"

# Deadtime interval (suppress duplicate notifications)
DEADTIME 15

# ============================================================================
# Battery Thresholds
# ============================================================================

# Low battery threshold (percentage)
LOWBATT 15

# Minimum battery level to allow FSD (Forced Shutdown)
# FSD is set when battery drops below this level

# ============================================================================
# Polling Frequency
# ============================================================================

# Polling frequency (fast, normal, slow)
POLLFREQ 5

# Polling frequency alert (when on battery)
POLLFREQALERT 5

# ============================================================================
# Host Sync
# ============================================================================

# Synchronize with power daemon (optional)
# HOSTSYNC 15

# ============================================================================
# Minimum required commands
# ============================================================================

# These are required for NUT to function properly
MINSUPPLIES 1
